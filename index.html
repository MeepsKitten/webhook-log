<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Log</title>
<style>
  :root { color-scheme: light dark; }
  body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 0; }
  header { position: sticky; top: 0; backdrop-filter: blur(6px); background: color-mix(in oklab, Canvas, transparent 25%); padding: 12px 16px; border-bottom: 1px solid color-mix(in oklab, CanvasText, transparent 90%); }
  h1 { font-size: 16px; margin: 0; }
  main { max-width: 900px; margin: 0 auto; padding: 16px; }
  ul { list-style: none; padding: 0; margin: 16px 0; display: grid; gap: 10px; }
  li { border: 1px solid color-mix(in oklab, CanvasText, transparent 85%); border-radius: 8px; padding: 10px 12px; }
  .meta { font-size: 12px; opacity: 0.7; margin-bottom: 6px; }
  pre { margin: 0; overflow: auto; background: color-mix(in oklab, CanvasText, transparent 95%); padding: 8px; border-radius: 6px; }
  .empty { opacity: .6; text-align: center; padding: 40px 0; }
</style>
</head>
<body>
<header><h1>Log</h1></header>
<main>
  <ul id="list"></ul>
  <div class="empty" id="empty" hidden>No entries yet.</div>
</main>
<script>
  const list = document.getElementById('list');
  const empty = document.getElementById('empty');

  async function fetchLog() {
    try {
      const res = await fetch('data/log.json', { cache: 'no-store' });
      const data = await res.json();
      render(data);
    } catch (e) { console.error(e); }
  }

  function render(entries) {
    list.innerHTML = '';
    if (!entries || !entries.length) { empty.hidden = false; return; }
    empty.hidden = true;
    for (const e of entries) {
      const li = document.createElement('li');
      li.innerHTML = `
        <div class="meta">${new Date(e.t).toLocaleString()}</div>
        <pre>${escapeHtml(JSON.stringify(e.payload, null, 2))}</pre>
      `;
      list.appendChild(li);
    }
  }

  function escapeHtml(s) {
    return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;','\'':'&#39;'}[c]));
  }

  fetchLog();
</script>
</body>
</html>


